<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">

        <title>從 AutoHotkey 碰觸程式設計</title>

        <meta name="description" content="從 AutoHotkey 碰觸程式設計">
        <meta name="author" content="Dino Lai">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
        <link rel="stylesheet" href="reveal.js/css/reveal.css">
        <link rel="stylesheet" href="reveal.js/css/theme/black.css" id="theme">

        <!-- Code syntax highlighting -->
        <link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

        <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
        <style>
        .reveal .slides {
            text-align: left;
        }

        .reveal .slides h1, h2, h3 {
            text-align: center;
        }
        </style>
    </head>

    <body>

        <div class="reveal">

            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">
                <!-- Use External -->
                <section data-markdown data-separator="^\n\n\n" data-separator-vertical="^\n\n">
                    <script type="text/template">
# 從 AutoHotkey「碰」觸程式設計

賴珈汶 (Dino Lai)

2016.04.13



## 安裝


### AutoHotkey

* [官網](https://autohotkey.com/)
  * Choose Unicode
* [文件](https://autohotkey.com/docs/AutoHotkey.htm)


### Sublime Text 3

* [官網](https://www.sublimetext.com/)

* [Package Control](https://packagecontrol.io/installation#st3)

* AutoHotkey Plugin
  * Preference &rarr; Package Control
  * Install Package
  * AutoHotkey



## 基本指令



## 鍵盤


### 自訂快捷鍵

* Syntax (句法)

```autohotkey
Send, Keys
```

* Example

```autohotkey
#h:: ; Win + h
  Send, Hello World ; Type Hello World
Return ; STOPS Code From going any further

::hw::
  Hello World
```

* 寄信名單

* [鍵盤符號表](https://www.autohotkey.com/docs/Hotkeys.htm#Symbols)


### 模擬鍵盤

```autohotkey
#h::
  Send, Hello World {Enter}
Return
```

* 試試 tab

* [特殊鍵名稱表](https://www.autohotkey.com/docs/commands/Send.htm)



## 開起程式

* Syntax

```autohotkey
Run, Target [, WorkingDir, Max|Min|Hide|UseErrorLevel, OutputVarPID]
```

* Example

```autohotkey
Run mspaint, , max
Run www.google.com.tw
```

```autohotkey
RunWait www.google.com.tw
Sleep, 2000 ; 等待兩秒
Send, garena
Send, {Enter}
Return
```



## 滑鼠


### Window Spy

* 常駐列 &rarr; AutoHotkey &rarr; 右鍵 &rarr; Window Spy
* 補圖


### 點擊

* Syntax

```autohotkey
MouseClick [, WhichButton , X, Y, ClickCount, Speed, D|U, R]
```

* Example

```autohotkey
MouseClick
MouseClick right, 44, 55
MouseClick right, 44, 55, 2
MouseClick right, 44, 55, 2, 50
MouseClick right, 44, 55, 2, , D
MouseClick right, 44, 55, 2, , D, R
```

* Wheel

```autohotkey
MouseClick WheelUp
MouseClick WheelDown, , , 2
MouseClick WheelLeft
MouseClick WheelRight
```

https://autohotkey.com/docs/commands/MouseClick.htm


### 移動滑鼠

* Syntax

```autohotkey
MouseMove, X, Y [, Speed, R]
```

* Example

```autohotkey
MouseMove 100, 100, 20
```


### 工單來囉

# 在小畫家裡畫出一條直線


### 拖曳滑鼠

* Syntax

```autohotkey
MouseClickDrag, WhichButton, X1, Y1, X2, Y2 [, Speed, R]
```

* Example

```autohotkey
MouseClickDrag, left, 100, 100, 200, 200
```

* 選擇一區塊的桌面圖示們刪除



## 訊息視窗

* Syntax

```autohotkey
MsgBox, Text
MsgBox [, Options, Title, Text, Timeout]
```

* Example

```autohotkey
MsgBox, Hello World
```

```autohotkey
MsgBox, 4, Are you sure, Would you like to continue?
ifMsgBox Yes
    MsgBox You pressed Yes.
else
    MsgBox You pressed No.
```


### 工單來囉

# 開啟小畫家，移到畫布左上角，畫出一個長方形，完成後，跳出一視窗顯示完成。



## PM 有話說

# 可以大一點嗎？


## 變數


### Storing values in variable

* 使用這種方法與一般程式語言用法較相近

```autohotkey
myBirthday := 19861011 ; store number
myName := "Dino" ; store string
copyOfMyName := myName
result := myBirthday * 2 + (10 - 2)
```

* 另一種寫法

```autohotkey
myBirthday = 19861011 ; store number
myName = Dino ; store string
copyOfMyName = %myName%
```

** Avoid Reserved Words **


### Variable in expression

* 要使用 % 表示我們有使用變數在裡面

* MsgBox

```autohotkey
clickTotal = 100
MsgBox, % "Click " . clickTotal . " Times"
```

* Loop

```autohotkey
clickTotal = 100
Loop % clickTotal {
    Click
}
```



## 主管有話說

# 可以多一點嗎？


## 流程控制

### 在進行以下實驗時，務必先此段 Code 放在檔案最後面

```autohotkey
Escape::
ExitApp
Return
```


### 迴圈

* Syntax

```autohotkey
Loop [, Count]
```

* 連點

```autohotkey
Loop 100 {
    MouseClick, Left
}
```

* 無限連點

```autohotkey
Loop {
    MouseClick, Left
}
```



## 老闆有話說

# 可以多到不能再多嗎？


### 選擇

* Syntax

```autohotkey
if (expression) {

} else if (expression) {

} else {

}
```

* Example

```autohotkey
Loop {
    if (a_index % 3 == 1) {
        MouseClick, Left
    } else if (a_index % 3 == 2) {
        MouseClick, Right
    } else {
        MouseClick, WheelUp
    }
}
```


### AND n OR

* 判斷是否在期間內

```autohotkey
FormatTime, OutputVar [, YYYYMMDDHH24MISS, Format]
```

```autohotkey
FormatTime, nowDate, , yyyyMMdd

if (nowDate >= 20160321 AND nowDate <= 20160419) {
    MsgBox, Hello Aries
}
```

* 除了零整除點右鍵，餘一餘二點左鍵

```autohotkey
Loop 10 {
    remainder := mod(a_index, 3)
    if (remainder == 1 OR remainder == 2) {
        MouseClick, Left
    } else if (remainder == 0 AND a_index > 3) {
        MouseClick, Right
    }
}
```



## 玩家有話說

# 可以螺旋的嗎？



## 封裝成 exe 檔

* test.ahk &rarr; 右鍵 &rarr; Compile Script &rarr; test.exe



# Thank You for Your Attention
                    </script>
                </section>
            </div>

        </div>

        <script src="reveal.js/lib/js/head.min.js"></script>
        <script src="reveal.js/js/reveal.js"></script>

        <script>

            // Full list of configuration options available at:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                controls: true,
                progress: true,
                slideNumber: true,
                history: true,
                center: true,

                transition: 'slide', // none/fade/slide/convex/concave/zoom

                // Optional reveal.js plugins
                dependencies: [
                    { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    // { src: 'reveal.js/plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
                    // remove condition for markdown code highlight
                    { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true },
                    { src: 'reveal.js/plugin/notes/notes.js', async: true }
                ]
            });

        </script>
    </body>
</html>
